{% extends "base.html" %}

{% block title %}Courses - PrepMyCert{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="text-center mb-5">
        <h1>ðŸ“š Certification Courses</h1>
        <p class="lead">Master your certification exams with our comprehensive practice tests</p>
    </div>

    {% if courses %}
        <div class="row">
            {% for course in courses %}
            <div class="col-lg-6 col-xl-4 mb-4">
                <div class="card h-100 course-card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="badge badge-secondary">{{ course.domain }}</span>
                            <span class="course-price">${{ "%.2f"|format(course.price) }}</span>
                        </div>
                    </div>
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ course.title }}</h5>
                        <p class="card-text text-muted flex-grow-1">{{ course.description }}</p>
                        
                        <div class="course-stats mb-3">
                            <div class="row text-center">
                                <div class="col-4">
                                    <div class="stat-number text-primary">{{ course.practice_test_count }}</div>
                                    <div class="stat-label">Practice Tests</div>
                                </div>
                                <div class="col-4">
                                    <div class="stat-number text-success">{{ course.question_count }}</div>
                                    <div class="stat-label">Questions</div>
                                </div>
                                <div class="col-4">
                                    <div class="stat-number text-info">âˆž</div>
                                    <div class="stat-label">Attempts</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-auto">
                            {% if current_user.is_authenticated %}
                                {% set user_purchase = current_user.purchases | selectattr('course_id', 'equalto', course.id) | list %}
                                {% if user_purchase %}
                                    <div class="alert alert-success text-center mb-2">
                                        <i class="fas fa-check-circle"></i> Purchased
                                    </div>
                                    <a href="{{ url_for('course_detail', course_id=course.id) }}" class="btn btn-success w-100">
                                        <i class="fas fa-play"></i> Start Practice Tests
                                    </a>
                                {% elif current_user.is_admin %}
                                    <div class="alert alert-info text-center mb-2">
                                        <i class="fas fa-user-shield"></i> Admin Access
                                    </div>
                                    <a href="{{ url_for('course_detail', course_id=course.id) }}" class="btn btn-warning w-100">
                                        <i class="fas fa-eye"></i> Preview Course
                                    </a>
                                {% else %}
                                    <a href="{{ url_for('course_detail', course_id=course.id) }}" class="btn btn-primary w-100">
                                        <i class="fas fa-info-circle"></i> View Details
                                    </a>
                                {% endif %}
                            {% else %}
                                <a href="{{ url_for('course_detail', course_id=course.id) }}" class="btn btn-primary w-100">
                                    <i class="fas fa-info-circle"></i> View Details
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center py-5">
            <i class="fas fa-graduation-cap fa-4x text-muted mb-3"></i>
            <h3>No Courses Available Yet</h3>
            <p class="text-muted">Check back soon for new certification courses!</p>
        </div>
    {% endif %}

    <!-- Why Choose PrepMyCert Section -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="card bg-light">
                <div class="card-body">
                    <h3 class="text-center mb-4">Why Choose PrepMyCert?</h3>
                    <div class="row">
                        <div class="col-md-3 text-center mb-4">
                            <i class="fas fa-brain fa-3x text-primary mb-3"></i>
                            <h5>Comprehensive Coverage</h5>
                            <p class="text-muted">All exam objectives covered across multiple practice tests</p>
                        </div>
                        <div class="col-md-3 text-center mb-4">
                            <i class="fas fa-chart-line fa-3x text-success mb-3"></i>
                            <h5>Progress Tracking</h5>
                            <p class="text-muted">Monitor your improvement with detailed analytics</p>
                        </div>
                        <div class="col-md-3 text-center mb-4">
                            <i class="fas fa-lightbulb fa-3x text-warning mb-3"></i>
                            <h5>Detailed Explanations</h5>
                            <p class="text-muted">Understand every answer with comprehensive explanations</p>
                        </div>
                        <div class="col-md-3 text-center mb-4">
                            <i class="fas fa-infinity fa-3x text-info mb-3"></i>
                            <h5>Unlimited Access</h5>
                            <p class="text-muted">Take practice tests as many times as you need</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Course Domains Filter (if we have multiple domains) -->
    {% set domains = courses | map(attribute='domain') | unique | list %}
    {% if domains | length > 1 %}
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5><i class="fas fa-filter"></i> Filter by Domain</h5>
                </div>
                <div class="card-body">
                    <div class="btn-group flex-wrap" role="group" aria-label="Domain filter">
                        <button type="button" class="btn btn-outline-primary active" onclick="filterCourses('all')">
                            All Domains
                        </button>
                        {% for domain in domains %}
                        <button type="button" class="btn btn-outline-primary" onclick="filterCourses('{{ domain }}')">
                            {{ domain }}
                        </button>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<script>
function filterCourses(domain) {
    const cards = document.querySelectorAll('.course-card');
    const buttons = document.querySelectorAll('.btn-group .btn');
    
    // Update button states
    buttons.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // Filter cards
    cards.forEach(card => {
        const cardDomain = card.querySelector('.badge-secondary').textContent;
        
        if (domain === 'all' || cardDomain === domain) {
            card.closest('.col-lg-6').style.display = 'block';
        } else {
            card.closest('.col-lg-6').style.display = 'none';
        }
    });
}
</script>

<style>
.course-card {
    border: none;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    border-radius: 0.5rem;
    transition: transform 0.2s, box-shadow 0.2s;
}

.course-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
}

.card-header {
    background-color: #f8f9fa;
    border-bottom: 1px solid #dee2e6;
    border-radius: 0.5rem 0.5rem 0 0 !important;
}

.course-price {
    font-size: 1.25rem;
    font-weight: bold;
    color: #28a745;
}

.course-stats {
    background-color: #f8f9fa;
    border-radius: 0.5rem;
    padding: 1rem;
}

.stat-number {
    font-size: 1.5rem;
    font-weight: bold;
}

.stat-label {
    font-size: 0.75rem;
    color: #6c757d;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.badge {
    font-size: 0.75em;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.alert {
    border: none;
    border-radius: 0.5rem;
    padding: 0.5rem;
    font-size: 0.875rem;
}

.btn {
    border-radius: 0.375rem;
}

.btn-group .btn {
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
}

.card-body {
    padding: 1.5rem;
}

.lead {
    font-size: 1.1rem;
    color: #6c757d;
}

@media (max-width: 767.98px) {
    .course-stats .col-4 {
        margin-bottom: 0.5rem;
    }
    
    .stat-number {
        font-size: 1.25rem;
    }
}
</style>
{% endblock %}